# 游戏手柄MIDI控制器

一个~~功能强大~~的游戏手柄到MIDI信号转换工具，支持实时参数控制和音符演奏。

## 📋 功能特性

- **摇杆控制**: 左右摇杆可控制MIDI CC参数，支持自定义CC通道
- **按键演奏**: 手柄按键可触发MIDI音符，支持自定义音高
- **相对控制模式**: 摇杆归位不会重置参数值，只在移动时改变参数
- **实时配置**: 图形界面支持实时调整所有参数
- **配置保存**: 自动保存和加载用户配置
- **多DAW兼容**: 支持所有接受MIDI输入的数字音频工作站

## 🎮 支持的控制器

- Xbox 360/One/Series 控制器
- PlayStation 3/4/5 控制器~~没有经过测试~~
- 其他标准游戏手柄（通过DirectInput）

## 📦 系统要求

- Windows 7/8/10/11 (64位)
- 游戏手柄（USB或无线连接）
- 虚拟MIDI端口软件（推荐loopMIDI）

## 🚀 快速开始

### 1. 准备工作

1. **连接游戏手柄**
   - 通过USB线连接手柄到电脑
   - 或使用蓝牙连接无线手柄
   - 确保Windows识别到手柄（在"设备和打印机"中可见）

2. **安装虚拟MIDI端口**
   - 下载并安装 [loopMIDI](https://www.tobias-erichsen.de/software/loopmidi.html)
   - 运行loopMIDI，点击"+"创建新端口
   - 端口名称建议设为："Gamepad MIDI 1"

### 2. 启动程序

1. 双击运行 `GamepadMIDIController.exe`
2. 程序将显示图形配置界面

### 3. 基本配置

1. **MIDI端口设置**
   - 在"MIDI端口"字段输入您在loopMIDI中创建的端口名
   - 默认为"Gamepad MIDI 1"

2. **摇杆灵敏度**
   - 调整滑块设置摇杆控制的灵敏度
   - 范围：0.5-10.0，默认3.0

3. **启动控制器**
   - 点击"启动控制器"按钮
   - 状态显示为"运行中"表示成功启动

## 🎛️ 控制映射

### 摇杆控制（MIDI CC）

| 控制 | 默认CC | 功能 |
|------|--------|------|
| 左摇杆 X轴 | CC 1 | 水平移动控制参数 |
| 左摇杆 Y轴 | CC 2 | 垂直移动控制参数 |
| 右摇杆 X轴 | CC 3 | 水平移动控制参数 |
| 右摇杆 Y轴 | CC 4 | 垂直移动控制参数 |

**操作说明：**
- 向上/右推摇杆：增加CC值
- 向下/左推摇杆：减少CC值
- 摇杆归位：停止改变参数值（不会重置）

### 按键控制（MIDI音符）

| 按键 | 默认音符 | 音名 |
|------|----------|------|
| A键 | 60 | C4 (中央C) |
| B键 | 62 | D4 |
| X键 | 64 | E4 |
| Y键 | 65 | F4 |
| 十字键↑ | 67 | G4 |
| 十字键↓ | 69 | A4 |
| 十字键← | 71 | B4 |
| 十字键→ | 72 | C5 |
| LB键 | 74 | D5 |
| RB键 | 76 | E5 |
| LT键 | 77 | F5 |
| RT键 | 79 | G5 |

## ⚙️ 高级配置

### 自定义CC映射

1. 在"摇杆CC映射"区域修改CC通道号（1-127）
2. 每个摇杆轴可以独立设置不同的CC通道
3. 修改后点击"保存配置"

### 自定义音符映射

1. 在"按键音符映射"区域修改音符值（0-127）
2. 音符对照表：C4=60, C#4=61, D4=62, 以此类推
3. 修改后点击"保存配置"

### 配置管理

- **保存配置**: 将当前设置保存到配置文件
- **加载配置**: 从配置文件恢复设置
- **重置默认**: 恢复所有设置为默认值

## 🎵 DAW集成示例

### FL Studio
1. 在FL Studio中打开"MIDI设置"
2. 启用"Gamepad MIDI 1"输入端口
3. 右键点击要控制的参数，选择"Link to controller"
4. 移动对应的摇杆完成链接

### Ableton Live
1. 在Live的"Preferences > MIDI"中启用"Gamepad MIDI 1"
2. 点击要控制参数的"MIDI"按钮
3. 移动摇杆完成MIDI学习

### Cubase
1. 在"Studio Setup > MIDI Port Setup"中添加端口
2. 使用"Generic Remote"功能映射CC控制

## 🔧 故障排除

### 常见问题

**Q: 程序提示"没有检测到手柄"**
- 确保手柄已正确连接并被Windows识别
- 检查手柄驱动是否正确安装
- 尝试重新连接手柄

**Q: 程序提示"无法打开MIDI端口"**
- 确保loopMIDI正在运行
- 检查端口名称是否与程序中设置的完全一致
- 确保端口没有被其他程序占用

**Q: DAW收不到MIDI信号**
- 确保DAW中已启用对应的MIDI输入端口
- 检查DAW的MIDI监视器是否显示输入信号
- 尝试重启DAW和本程序

**Q: 摇杆控制不灵敏或过于敏感**
- 调整程序中的"摇杆灵敏度"设置
- 检查手柄是否存在摇杆漂移问题

**Q: 按键没有反应**
- 检查音符映射设置是否正确
- 确保DAW正在监听MIDI音符输入
- 尝试在DAW中手动测试MIDI输入

### 高级故障排除

**重置程序**
1. 关闭程序
2. 删除配置文件 `gamepad_midi_config.json`
3. 重新启动程序

**查看详细日志**
- 程序界面底部的"运行日志"区域显示详细的操作信息
- 可以帮助诊断连接和MIDI发送问题

## 📝 更新日志

### v0.0.1preview
- 初始版本发布
- 支持摇杆CC控制和按键音符演奏
- 图形化配置界面
- 配置文件保存/加载功能
### v0.0.2preview
- 音符名称映射
- - 创建128个MIDI音符的完整映射
- - 实时更新音符名称显示
- - 支持升号表示法（C#、D#等）
-  改进的错误处理
- - 更好的MIDI端口管理
- - 线程安全的停止机制
- - 详细的错误日志记录

## 🤝 技术支持

如果您遇到问题或有功能建议，请：

1. 检查本文档的故障排除部分
2. 确保按照步骤正确配置
3. 记录错误信息和操作步骤

## 📄 许可证

本软件仅供个人和教育用途使用。
## 👆🤓声明

本软件使用了AI编程


详细的错误日志记录
---

**享受用游戏手柄控制音乐的乐趣！** 🎮🎵
